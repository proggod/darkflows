(()=>{var e={};e.id=483,e.ids=[483],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79646:e=>{"use strict";e.exports=require("child_process")},91177:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>j,routeModule:()=>x,serverHooks:()=>y,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>g});var t={};s.r(t),s.d(t,{DELETE:()=>w,GET:()=>v,POST:()=>h});var a=s(42706),o=s(28203),n=s(45994),i=s(39187);let u=require("fs");var c=s(79646);let d="/etc/kea/kea-dhcp4.conf";async function p(){try{let e=(await u.promises.readFile(d,"utf-8")).replace(/,(\s*[}\]])/g,"$1").replace(/,(\s*})/g,"}").replace(/,(\s*\])/g,"]");return JSON.parse(e)}catch(e){throw console.error("Error parsing Kea config:",e),e}}async function l(e){let r=new Set;e.Dhcp4.subnet4[0].reservations=e.Dhcp4.subnet4[0].reservations.filter(e=>{let s=`${e["ip-address"]}-${e["hw-address"].toLowerCase()}`;return!r.has(s)&&(r.add(s),!0)}),await u.promises.writeFile(d,JSON.stringify(e,null,2));try{await new Promise((e,r)=>{(0,c.exec)("sudo systemctl reload kea-dhcp4-server",s=>{s?(console.warn("Could not reload Kea configuration:",s),r(s)):e(!0)})})}catch(e){console.warn("Could not reload Kea configuration:",e)}}async function v(){try{let e=(await p()).Dhcp4.subnet4[0].reservations;return i.NextResponse.json(e)}catch(e){return console.error("Error reading reservations:",e),i.NextResponse.json({error:"Failed to read reservations"},{status:500})}}async function h(e){try{let r=await e.json(),s=await p();if(s.Dhcp4.subnet4[0].reservations.some(e=>e["ip-address"]===r["ip-address"]||e["hw-address"].toLowerCase()===r["hw-address"].toLowerCase()))return i.NextResponse.json({error:"Reservation with this IP or MAC address already exists"},{status:409});return s.Dhcp4.subnet4[0].reservations.push(r),await l(s),i.NextResponse.json({success:!0})}catch(e){return console.error("Error adding reservation:",e),i.NextResponse.json({error:"Failed to add reservation"},{status:500})}}async function w(e){try{let{ip:r,mac:s}=await e.json(),t=await p();return t.Dhcp4.subnet4[0].reservations=t.Dhcp4.subnet4[0].reservations.filter(e=>e["ip-address"]!==r&&e["hw-address"]!==s),await l(t),i.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting reservation:",e),i.NextResponse.json({error:"Failed to delete reservation"},{status:500})}}let x=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/reservations/route",pathname:"/api/reservations",filename:"route",bundlePath:"app/api/reservations/route"},resolvedPagePath:"/usr/local/darkflows/src/live-ifstat/app/api/reservations/route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:f,workUnitAsyncStorage:g,serverHooks:y}=x;function j(){return(0,n.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:g})}},96487:()=>{},78335:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[994,452],()=>s(91177));module.exports=t})();